# SECURITY PRACTICES

## USER SECURITY

### AUTHENTICATION METHODS

Traditional authentication methods has many security vunerabilities.
- Users might share their credentials.
- Passwords generated by users are easy to guess.
- Each server has own credentials databases, users has to enter credentials everytime.

**Kerberos**

* Supports **Single Sign-On (SSO)** for user authentication.
* Tickets are obtained and cached using the **kinit** utility, and can be viewed with **klist**.

<img src="images/Kerberos.png">

---

**LDAP ( Lightweight Directory Access Protocol )**

- Network administrators often use **Kerberos for authentication** alongside **LDAP for authorization**.
- LDAP directories can be distributed across **multiple servers** for **scalability** and **redundancy**.

<img src="images/ldap.png">

---

**RADIUS**

- A protocol used for **centralized authentication, authorization and accounting**.
- It enables an authentication server to verify user credentials as well as additional user-related information.

<img src="images/radius.png">

---

**TASCACS+ ( Terminal Access Controller Access Control System )**

- A protocol that provides centralized Authentication, Authorization, and Accounting (AAA).
- Each server independently sends authentication requests.
- TACACS+ supports full encryption of communication for enhanced security.

---

### MULTIFACTOR AUTHENTICATION

Something you **Know** : Password, PIN, Security question.\
Something you **Posses** : Smartphone (OTP / authenticator app), smart card, digital token.\
Something you **Are** : Biometrics: fingerprint, face scan, voice recognition.

---

### UNIQUE USER ACCOUNTS

- **Non-repudiation** ensures that every user action can be reliably traced back to the individual who performed it.
- User accounts should never be shared among multiple users.

---

### STRONG PASSWORDS

* Passwords should be **complex** and **changed regularly**.
* Users can be required to update their passwords by configuring **/etc/login.defs**, with settings like `PASS_MAX_DAYS`.
* **strong password policies** can be enforced with **PAM** and the **/etc/pam.d/system-auth** file.

---

### RESTRICT ROOT ACCOUNT

**Completely disable direct root login**

- Regular users can still gain root privileges using `su` or `sudo`.
- Set the root shell to **/usr/bin/nologin** in **/etc/passwd**:
```
root:x:0:0:root:/root:/usr/bin/nologin
```

**Restrict root login to specific devices**

- The **/etc/securetty** file lists the TTY devices from which root is allowed to log in.
- If this file is empty, root cannot log in from any local terminal.

**Disable root login over SSH**

- Edit the OpenSSH server configuration: **/etc/ssh/sshd_config**
- Set the following directive:
```
PermitRootLogin no
```

---

## SYSTEM SECURITY

### SEPERATION OF DATA

- Use separate partitions for major mount points like **/** and **/home** to prevent users from consuming excessive disk space.

### DISK ENCRYPTION

* Encrypt the entire drive rather than individual files.
* LUKS (Linux Unified Key Setup) utilizes **dm-crypt** and **cryptmount** for disk encryption.
    - Operates at the **kernel** level for seamless integration.
    - The kernel handles **decryption automatically** when files are accessed.

### RESTRICTING APPLICATIONS

- In multi-user environments, simultaneous usage can lead to **data conflicts**.
- Use a **chroot jail** to isolate applications.
  * This runs the application in a separate root directory structure.
  * Example usage:
```
sudo chroot /starting_dir command
```

### PREVENT UNAUTHORIZED REBOOTING

- preventing attackers physically rebooting and taking control.
    + block access to **BIOS/UEFI** by setting a BIOS password.
    + preventing access to **grub** by setting a password.
        * create an **encrypted-key** --> `$ grub-mkpasswd-pbkdf2`
        * add the **encrypted-key** to grub : **/etc/grub.d/40_custom** file.
        ```
        set superuser="[ user ]"
        password_pbkdf2 [ user ] [ encrypted-key ]

        ```

- disable the ctrl+alt+del combination
    + for systemd systems --> `$ sudo systemctl mask ctrl-alt-del.target`

### RESTRICTING UNAPPROVED JOBS

- users can run **cron** and **at** jobs, even when they are logged out.
- block unauthorized users from adding cron jobs using **/etc/at.allow** , **/etc/at.deny** , **/etc/cron.allow** , **/etc/cron.deny**.
    + if the user is found in the **allow** file, user is allowed.
    + if the user is not found in **allow**, **deny** is checked.
    + if the user is found in **deny**, user is blocked.
    + if the user is not found in **deny**, user is allowed.

### BANNERS AND MESSAGES

- **/etc/login.warn** : display content of the file, before login prompt.
- **/etc/motd**  : display content of the file, after login.

### RESTRICTING USB DEVICES

- when a user plugin a USB storage drive, kernal looks for a module to support the device.
- if none is found, calls **modprobe** utility to automatically load appropriate module.
- **modprobe** config : **/etc/modprobe.d/blacklist.conf**.
- kernal loads **uas** & **usb:storage** when a usb is connected --> add **uas** & **usb:storage** to **blacklist.conf**.

### KEEP UP WITH LATEST THREATS

- cve.mitre.org

### AUDITING

- logs are informative, for even more robust solution use **audit** package.
- **audit** allows logging many system events.
    + file / directory access by users.
    + system calls made by apps.
    + specific commands run by users.
    + network access by users.
    + network connections attempted by external users.
- types of rules.
    + system rules : log system calls by apps.
    + file system rules : log access to files & directories.
    + control rules : **audit** application behavior.

---

## NETWORK SECURITY

### DENY HOSTS

- use **/etc/hosts.deny**.

### DISABLE UNUSED SERVICES

- there are many legecy network apps, hanging around the system.
    + FTP
    + Telnet
    + Finger : remotely lookup and find a user.
    + Mail services.

### CHANGE DEFAULT PORTS

- port types
    + well-known ports (0-1023)
    + registered ports (1024-49151)
    + private ports (49151+)

! some admins like to move applications that use well-known ports to private ports.

### ENCRYPTION ON NETWORK

- Do not send plain data through networks.
- use apps with **SSL** and **TLS** support.
